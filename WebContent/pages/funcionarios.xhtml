<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	      xmlns:f="http://xmlns.jcp.org/jsf/core"
      	  xmlns:h="http://xmlns.jcp.org/jsf/html"
      	  xmlns:p="http://primefaces.org/ui">
	<h:head>
		<title>ERP Web</title>
		<h:outputStylesheet library="css" name="app.css" />
		<h:outputScript library="js" name="primefaces-calendar-pt_BR.js"/>
	</h:head>
	<h:body>
		<div id="cabecalho">
			<ul id="menu-principal">
				<li>
					<h:link value="Funcionários" outcome="/pages/funcionarios" />
				</li>
			</ul>
		</div>
		
		<p:outputPanel autoUpdate="true" rendered="false">
			<h:messages id="msg" errorClass="errors" infoClass="notice" />
		</p:outputPanel>
		
		<p:messages autoUpdate="true" rendered="false"/>
		<p:growl autoUpdate="true"/>
		 
		<div id="conteudo">
			<div id="ajax-loading">
				<p:ajaxStatus>
					<f:facet name="start">
	                    <h:graphicImage library="imagens" name="ajax-loader.gif" />
	                </f:facet>
					<f:facet name="complete">
						<h:outputText value="" />
	                </f:facet>
				</p:ajaxStatus>
			</div>
			<div id="container">
				<h:form id="form">
					<h1>
						<h:outputText value="Novo Funcionário" 
							rendered="#{empty funcionarioBean.funcionario.id}" />
		
						<h:outputText value="Editar Funcionário" 
							rendered="#{not empty funcionarioBean.funcionario.id}" />
					</h1>
					
					<h:inputHidden value="#{funcionarioBean.funcionario.id}" />
				
						<h:outputLabel value="Nome" for="nome" />
						<h:inputText id="nome" value="#{funcionarioBean.funcionario.nome}" 
							styleClass="texto-longo" required="true" label="Nome">
							<f:validateRegex pattern="[a-zA-Z]+" />
						</h:inputText>
			
						<h:outputLabel value="Endereço" for="endereco" />
						<h:inputTextarea id="endereco" 
							value="#{funcionarioBean.funcionario.endereco}" rows="3"
							styleClass="texto-longo" label="Endereço" />
			
						<h:outputLabel value="Data de Nascimento" for="data" />
						<p:calendar id="data" value="#{funcionarioBean.funcionario.dataDeNascimento}"
							required="true" label="Data de Nascimento" pattern="dd/MM/yyyy" mask="true"
							locale="pt">
							<f:validator validatorId="maiorDeIdadeValidator"/>
						</p:calendar>
						
						<h:outputLabel value="Salário" for="salario" />
						<p:inputNumber id="salario" value="#{funcionarioBean.funcionario.salario}"
							label="Salário" thousandSeparator="." decimalSeparator=",">
						</p:inputNumber>
						
						<h:outputLabel value="Cargo" for="cargo" />
						<p:selectOneMenu id="cargo" value="#{funcionarioBean.funcionario.cargo}"
							label="Cargo">
							<f:selectItem itemValue="DBA" itemLabel="DBA"/>
							<f:selectItem itemValue="DESENVOLVEDOR" itemLabel="Desenvolvedor"/>
							<f:selectItem itemValue="ANALISTA_DE_SISTEMAS" itemLabel="Analista de Sistemas"/>
							<f:selectItem itemValue="GERENTE_DE_PROJETOS" itemLabel="Gerente de Projetos"/>
						</p:selectOneMenu>
		
					<div class="acoes-principais">
						<h:commandLink value="Cancelar" action="funcionarios.xhtml" immediate="true">
						</h:commandLink >
						&#160;
						<h:commandButton value="Salvar" action="#{funcionarioBean.salva}">
							<f:ajax execute="@form" render="@form"/>
						</h:commandButton>
					</div>
					
					<p:dataTable value="#{funcionarioDataModel}" var="funcionario"
						paginator="true" rows="5" lazy="true">
						<p:column headerText="ID" style="width:5%">
							#{funcionario.id}
						</p:column>
						<p:column headerText="Nome">
							#{funcionario.nome}
						</p:column>
						<p:column headerText="Data de Nascimento">
							<h:outputText value="#{funcionario.dataDeNascimento}">
								<f:convertDateTime pattern="dd/MM/yyyy" />
							</h:outputText>
						</p:column>
						<p:column headerText="Cargo">
							#{funcionario.cargo.descricao}
						</p:column>
						<p:column headerText="Ações">
							<h:commandLink value="remover" 
								action="#{funcionarioBean.remove(funcionario)}" immediate="true">
								<f:ajax render="@form" />
							</h:commandLink>
							&#160;
							<h:commandLink value="alterar" immediate="true" action="funcionarios.xhtml">
								<f:setPropertyActionListener value="#{funcionario}" 
										target="#{funcionarioBean.funcionario}" />
							</h:commandLink>
						</p:column>
					</p:dataTable>
				</h:form>
			</div>
		</div>
		
		<div id="rodape">
		     <div class="rodape-bar">
				<strong>ERP Web</strong> - TriadWorks
			</div>
		</div>
	</h:body>
</html>